<!DOCTYPE html>
<html>
  <head>
    <title>   Home</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.0/html2pdf.bundle.min.js"></script>
    <link rel='stylesheet' href='/stylesheets/home.css' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:ital,wght@1,200&family=KoHo&family=Prompt:ital,wght@0,300;1,300&display=swap');
        * {
            font-family: 'Prompt';
        }
        .material-icons { 
            display: inline-flex; 
            vertical-align: text-bottom;
        }
        .imgl {
          border-radius: 50%;
        }
        .imgg {
          border-radius: 50%;
          width:40px;
          height: 40px;
        }
        .gp {
          font-size: 20px;
          color: rgb(10, 10, 10);
          font-family: Georgia, 'Times New Roman', Times, serif;

        }
        .egp {
          font-size: 30px;
          color: rgb(10, 10, 10);
          font-family: Georgia, 'Times New Roman', Times, serif;

        }

        .sod {
          font-size: 22px;
          color: rgb(10, 10, 10);
          font-family: Georgia, 'Times New Roman', Times, serif;

        }
        .re {
            font-family: Georgia, 'Times New Roman', Times, serif;
            background-color: rgb(255, 255, 255);
            
        }
        .re2 {
            margin-top: 20px;
        }
   
     
    
       
    </style>
  </head>
  <body>

    <header>
      <tbody>
        <table class="table table">
          <tr class="text-center">
            <td width="5%"><img class="imgl" src="/images/<%= informations.img %>" width="50px" /></td>
            <td width="32%"><span class="name float-left"><a class="name" href='/'><%= informations.name %></a></span></td>
                
            <td><span class="name2 float-right">
              <nav class="navigation">

                <% if (session.token == undefined) { %>
                  <span>
                    <a class="btn btn bu" href="/login">Login</a>
                  </span>
                  <a class="btn btn bu" href="/register">Register</a>
                <% } %>

                <% if (session.token != undefined) { %>
                  <span>
                    <img class="imgg" src="../images/<%= session.profile %>" width="10px" />
                    <span class="name2">
                      <%= 'ชื่อผู้ใช้ : ' +session.name + " | "%>
                      <b class="bu2"> <%= 'Level : ' + session.level%> </b>

                    </span>
                    

                    
                    <a class="btn btn-danger bu2" href="/logout" onclick="return confirm('Are you Sure ?')">
                      <span class="material-symbols-outlined material-icons">
                        logout
                      </span>
                      Logout
                    </a>
                  </span>
                 
                <% } %>


              </nav>
            </span>
          </td>
         </tr>
        </table>
    </tbody>

    
  </header>

  

      <div class="wrapper_l">
        <% if (session.level == 'admin') { %>
        <div class="box">
          <h2>จัดการการตั้งค่าระบบ</h2>
            <ul>
              <li>
                <a href="/groupProduct">
                <span class="material-symbols-outlined material-icons">
                  format_list_bulleted
                  </span>
                ประเภทสินค้า </a>
              </li>
              <li>
                <a href="/product">
                  <span class="material-symbols-outlined material-icons">
                    category
                    </span>
                  สินค้า</a></li>
              <li>
                <a href="/order">
                  <span class="material-symbols-outlined material-icons">
                    grade
                    </span>
                  ยอดสั่งซื้อ</a>
              </li>
              <li>
                <a href="/changeInformation">
                  <span class="material-symbols-outlined material-icons">
                    terminal
                    </span>
                    จัดการข้อมูลเว็บ</a>
              </li>
              <li>
                <a href="/user">
                  <span class="material-symbols-outlined material-icons">
                    person
                    </span>
                    ผู้ใช้งานระบบ</a>
              </li>
              <li>
                <a href="/changeProfile">
                  <span class="material-symbols-outlined material-icons">
                    settings
                    </span>
                    แก้ไขข้อมูลส่วนตัว</a>
              </li>
              <li>
                <a href="/changeHighLight">
                  <span class="material-symbols-outlined material-icons">
                    apps
                    </span>
                    แก้ไขไฮไลค์ประจำเว็บ</a>
              </li>
            </ul>
        </div>
        <% } %>

        <% if (session.level == 'member') { %>
        <div class="box">
          <h2>จัดการการตั้งค่าระบบ</h2>
            <ul>
              <li>
                <a href="/changeProfile">
                <span class="material-symbols-outlined material-icons">
                  format_list_bulleted
                  </span>
                แก้ไขข้อมูลส่วนตัว </a>
              </li>
              <li>
                <a href="/trackOrder">
                  <span class="material-symbols-outlined material-icons">
                    local_shipping
                  </span>
                  ติดตามคำสั่งซื้อ
                </a>
              </li>
              <li>
                <a  href="/mycart">
                  <span class="material-symbols-outlined material-icons">
                      shopping_cart
                  </span>
                  <%= session.card.length %>
                  ตะกร้าสินค้า
              </a>
              </li>
            </ul>
        </div>
        <% } %>
          
              <% if (session.token != undefined) { %>
              <a class="btn btn tt ml-5 mt-1" href="/trackOrder">
                <span class="material-symbols-outlined material-icons">
                  local_shipping
                </span>
                ติดตามคำสั่งซื้อ
              </a>
              <% } %>
              <div class="float-right mt-2">
                <% if (session.token != undefined) { %>
                <a class="btn btn-success" href="/mycart">
                    <span class="material-symbols-outlined material-icons">
                        shopping_cart
                    </span>
                    <%= session.card.length %>
                    ยืนยันการซื้อ
        
                <% } %>
                </a>
              </div>
              <div class="clearfix"></div>
              

              <div id="carouselExampleIndicators" class="carousel slide bg_ok" data-ride="carousel">
                <h2 class="textt">หนังสือแนะนำ !</h2>
                <ol class="carousel-indicators">
                  <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <img src="/images/<%= informations.p1 %>" class="d-block w-100" alt="First slide" height="530px">
                  </div>
                  <div class="carousel-item">
                    <img src="/images/<%= informations.p2 %>" class="d-block w-100" alt="Second slide" height="530px">
                  </div>
                  <div class="carousel-item">
                    <img src="/images/<%= informations.p3 %>" class="d-block w-100" alt="Third slide" height="530px">
                  </div>
                </div>
                <button class="carousel-control-prev" type="button" data-target="#carouselExampleIndicators" data-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-target="#carouselExampleIndicators" data-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </button>
              </div>

        

      </div>


<div id = "invoice" style="padding: 0 50px; font-size:15px;">
      <div class="container sod re ">
          <table border="0">
              <tr>
                  <td height="20px">

                  </td>
              </tr>
          </table>
      </div>

  <div class="container sod re">

          <div class=" ml-4"><b>ใบกำกับสินค้า</b>     </div>

          <div class="ml-4"><p><b><h5>วันที่ : <%= dayjs(result.pay_date).format(dayFormat) %></h5></b></p></div>
          <table border="0">
              <tr>
                  <td width="30%" colspan="2">
                      <div style="text-align:left;" class="ml-4">
                          <img src="../images/<%= informations.img %>" width="200px" />
                      </div>
                  </td>
                  <td>
                      <p><b><h5>ร้าน : <%= informations.name %></h5></b></p>
                      <p><b><h5>ที่อยู่ : <%= informations.address %></h5></b></p>
                      <p><b><h5>เบอร์ติดต่อ : <%= informations.phone %></h5></b></p>
                      <p><b><h5></h5>เมลล์ : <%= informations.email %></b></p>
                  </td>
              </tr>

            <table border="0">
              <tr>
                <td width="50%"><div class=""><p><b><h5>ลูกค้า : <%= result.name %></h5></b></p></td></div>
              </tr>
              <tr>
                <td width="50%"><div class=""><p><b><h5>ที่อยู่ : <%= result.homeid + ' หมู่ ' + result.muid + ' ตำบล' + result.tambon + ' อำเภอ'+ result.district + ' จังหวัด' + result.province +' รหัสไปรษณีย์ '+ result.zip %></h5></b></p></td></div>
  
              </tr>
              <tr>
                <td colspan="3" style="text-align:center;"><p><b><h5>รายการคำสั่งซื้อ</h5></b></p></td>
              </tr>
            </table>
            
          </table>

          <table border="1" width="100%" class="ml-1" >
              <tr style="text-align:center;">
                  <td><p><b><h5>ลำดับ</h5></b></p></td>
                  <td width="45%"><p><b><h5>สินค้า</h5></b></p></td>
                  <td><p><b><h5>จำนวน</h5></b></p></td>
                  <td><p><b><h5>จำนวนเงินต่อเล่ม</h5></b></p></td>
                  <td><p><b><h5>หน่วย</h5></b></p></td>
              </tr>

                <% products.forEach((product) => { %>

                <tr style="text-align:center;">
          
                    <td><%=product.id%></td>
                    <td><%= product.name %></td>
                    <td><%=product.qty%></td>
                    <td><%=product.price%></td>
                    <td>บาท</td>
                </tr>
                <% }) %>
              <tr>
                  <td colspan="3">ค่าจัดส่ง</td>
                  <td style="text-align:center;">0</td>
                  <td style="text-align:center;">บาท</td>
              </tr>
              <tr>
                  <td colspan="3"> รวมเป็นเงินทั้งสิ้น</td>
                  <td style="text-align:center;">
                    <%= total_price %>
                </td>

                  <td style="text-align:center;">บาท</td>
              </tr>
          </table>

          <table border="0">
              <tr>
                  <td height="30px">

                  </td>
              </tr>
          </table>
          
      </div>
  </div>
</div>

<div class="container sod re">

  <div class="butt">
      <table border="0" width="94%" class="mt-0 butt">
          <tr>
              <div class="ml-3">
                  <td style="text-align:right;">
                      <button  class="btn btn-danger" id = "exportPDF" onclick="generatePDF()">
                          ดาวโหลดไฟล์ PDF
                      </button>
                  </td>
              </div>
          </tr>
      </table>
  </div>
</div>

<script>
  function generatePDF() {
      const elements = document.getElementById("invoice");

      const options = {
          margin: 10,
          filename: 'ใบเสร็จ.pdf',
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { scale: 2 },
          jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };

      html2pdf()
          .set(options)
          .from(elements)
          .save();
  }
</script>

<%- include('../footer') %>